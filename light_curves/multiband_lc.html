
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Make multiwavelength light curves using archival data &#8212; Fornax Demo Notebooks</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Light Curve Classifier" href="lc_classifier.html" />
    <link rel="prev" title="Time Domain" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/fornax_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fornax Demo Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Fornax Demo Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../forced_photometry/README.html">
   Multi-band forced photometry
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../forced_photometry/multiband_photometry.html">
     Automated Multiband Forced Photometry on Large Datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Time Domain
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Make multiwavelength light curves using archival data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lc_classifier.html">
     Light Curve Classifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ML_AGNzoo.html">
     How do AGNs selected with different techniques compare?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/fornax-navo/fornax-demo-notebooks/main?urlpath=tree/light_curves/multiband_lc.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/fornax-navo/fornax-demo-notebooks/blob/main/light_curves/multiband_lc.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/fornax-navo/fornax-demo-notebooks"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/fornax-navo/fornax-demo-notebooks/issues/new?title=Issue%20on%20page%20%2Flight_curves/multiband_lc.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/fornax-navo/fornax-demo-notebooks/edit/main/light_curves/multiband_lc.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/light_curves/multiband_lc.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/light_curves/multiband_lc.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-goals">
   Learning Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#input">
   Input:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output">
   Output:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-standard-imports">
   Non-standard Imports:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#authors">
   Authors:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgements">
   Acknowledgements:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-sample">
   1. Define the Sample
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-your-own-sample">
     1.1 Build your own Sample
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-out-your-sample-to-disk">
     1.2 Write out your sample to disk
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-sample-table-from-disk">
     1.3 Load the sample table from disk
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporary-cell-remove-when-all-functions-take-a-table-sample-table-rather-than-lists">
     Temporary cell, remove when all functions take a Table sample_table rather than lists
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-nasa-catalogs">
   2. Find light curves for these targets in NASA catalogs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heasarc-fermi-beppo-sax">
     2.1 HEASARC: FERMI &amp; Beppo SAX
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irsa-ztf">
     2.2 IRSA: ZTF
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irsa-wise">
     2.3 IRSA: WISE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-pan-starrs">
     2.4 MAST: Pan-STARRS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-asteroid-terrestrial-impact-last-alert-system-atlas">
     2.5 MAST: Asteroid Terrestrial-impact Last Alert System (ATLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-tess-kepler-and-k2">
     2.6 MAST: TESS, Kepler and K2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-hcv">
     2.7 MAST: HCV
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">
   3. Find light curves for these targets in relevant, non-NASA catalogs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaia">
     3.1 Gaia
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#asas-sn-all-sky-automated-survey-for-supernovae">
     3.2 ASAS-SN (all sky automated survey for supernovae)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#icecube-neutrinos">
     3.3 Icecube Neutrinos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parallel-processing-the-archive-calls">
   4. Parallel Processing the archive calls
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">
   5. Make plots of luminosity as a function of time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Make multiwavelength light curves using archival data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-goals">
   Learning Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#input">
   Input:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output">
   Output:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-standard-imports">
   Non-standard Imports:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#authors">
   Authors:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgements">
   Acknowledgements:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-sample">
   1. Define the Sample
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-your-own-sample">
     1.1 Build your own Sample
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-out-your-sample-to-disk">
     1.2 Write out your sample to disk
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-sample-table-from-disk">
     1.3 Load the sample table from disk
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporary-cell-remove-when-all-functions-take-a-table-sample-table-rather-than-lists">
     Temporary cell, remove when all functions take a Table sample_table rather than lists
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-nasa-catalogs">
   2. Find light curves for these targets in NASA catalogs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heasarc-fermi-beppo-sax">
     2.1 HEASARC: FERMI &amp; Beppo SAX
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irsa-ztf">
     2.2 IRSA: ZTF
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irsa-wise">
     2.3 IRSA: WISE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-pan-starrs">
     2.4 MAST: Pan-STARRS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-asteroid-terrestrial-impact-last-alert-system-atlas">
     2.5 MAST: Asteroid Terrestrial-impact Last Alert System (ATLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-tess-kepler-and-k2">
     2.6 MAST: TESS, Kepler and K2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-hcv">
     2.7 MAST: HCV
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">
   3. Find light curves for these targets in relevant, non-NASA catalogs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaia">
     3.1 Gaia
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#asas-sn-all-sky-automated-survey-for-supernovae">
     3.2 ASAS-SN (all sky automated survey for supernovae)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#icecube-neutrinos">
     3.3 Icecube Neutrinos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parallel-processing-the-archive-calls">
   4. Parallel Processing the archive calls
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-of-luminosity-as-a-function-of-time">
   5. Make plots of luminosity as a function of time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="make-multiwavelength-light-curves-using-archival-data">
<h1>Make multiwavelength light curves using archival data<a class="headerlink" href="#make-multiwavelength-light-curves-using-archival-data" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this headline">#</a></h2>
<p>By the end of this tutorial, you will be able to:</p>
<ul class="simple">
<li><p>automatically load a catalog of sources</p></li>
<li><p>automatically search NASA and non-NASA resources for light curves</p></li>
<li><p>store light curves in a Pandas multiindex dataframe</p></li>
<li><p>plot all light curves on the same plot</p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction:<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>A user has a sample of interesting targets for which they would like to see a plot of available archival light curves.  We start with a small set of changing look AGN from Yang et al., 2018, which are automatically downloaded. Changing look AGN are cases where the broad emission lines appear or disappear (and not just that the flux is variable).</p></li>
<li><p>We model light curve plots after van Velzen et al. 2021.  We search through a curated list of time-domain NASA holdings as well as non-NASA sources.  HEASARC catalogs used are Fermi and Beppo-Sax, IRSA catalogs used are ZTF and WISE, and MAST catalogs used are Pan-Starrs, TESS, Kepler, and K2.  Non-NASA sources are Gaia and IceCube. This list is generalized enough to include many types of targets to make this notebook interesting for many types of science.  All of these time-domain archives are searched in an automated fashion using astroquery or APIs.</p></li>
<li><p>Light curve data storage is a tricky problem.  Currently we are using a multi-index Pandas dataframe, as the best existing choice for right now.  One downside is that we need to manually track the units of flux and time instead of relying on an astropy storage scheme which would be able to do some of the units worrying for us (even astropy can’t do all magnitude to flux conversions).  Astropy does not currently have a good option for multi-band light curve storage.</p></li>
<li><p>We intend to explore a ML classifier for these changing look AGN light curves.</p></li>
</ul>
</section>
<section id="input">
<h2>Input:<a class="headerlink" href="#input" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>choose from a list of known changing look AGN from the literature</p></li>
</ul>
<p>OR -</p>
<ul class="simple">
<li><p>input your own sample</p></li>
</ul>
</section>
<section id="output">
<h2>Output:<a class="headerlink" href="#output" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>an archival optical + IR + neutrino light curve</p></li>
</ul>
</section>
<section id="non-standard-imports">
<h2>Non-standard Imports:<a class="headerlink" href="#non-standard-imports" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">acstools</span></code> to work with HST magnitude to flux conversion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astropy</span></code> to work with coordinates/units and data structures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astroquery</span></code> to interface with archives APIs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hpgeom</span></code> to locate coordinates in HEALPix space</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lightkurve</span></code> to search TESSS, Kepler, and K2 archives</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> to work with Parquet files for WISE and ZTF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s3fs</span></code> to connect to AWS S3 buckets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">urllib</span></code> to handle archive searches with website interface</p></li>
</ul>
</section>
<section id="authors">
<h2>Authors:<a class="headerlink" href="#authors" title="Permalink to this headline">#</a></h2>
<p>Jessica Krick, Shoubaneh Hemmati, Andreas Faisst, Troy Raen, Brigitta Sipőcz, Dave Shupe</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements:<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">#</a></h2>
<p>Suvi Gezari, Antara Basu-zych,Stephanie LaMassa<br />
MAST, HEASARC, &amp; IRSA Fornax teams</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ensure all dependencies are installed</span>
<span class="o">!</span>pip install -r requirements.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting git+https://github.com/sevamoo/SOMPY (from -r requirements.txt (line 17))
  Cloning https://github.com/sevamoo/SOMPY to /private/var/folders/9s/070g0pd502q70k3gffpxv8km0000gq/T/pip-req-build-v9tvs56t
  Running command git clone --filter=blob:none --quiet https://github.com/sevamoo/SOMPY /private/var/folders/9s/070g0pd502q70k3gffpxv8km0000gq/T/pip-req-build-v9tvs56t
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Resolved https://github.com/sevamoo/SOMPY to commit 6aca604b06e5eea1391ecf507810c7aabafc3f8b
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Preparing metadata (setup.py) ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
?25hRequirement already satisfied: acstools in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 4)) (3.6.1)
Requirement already satisfied: astropy in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 5)) (6.0.dev560+gf2a40ddd0)
Requirement already satisfied: astroquery in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 6)) (0.4.7.dev8947)
Requirement already satisfied: hpgeom in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 7)) (1.0.0)
Requirement already satisfied: lightkurve in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 8)) (2.4.2)
Requirement already satisfied: matplotlib in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 9)) (3.7.1)
Requirement already satisfied: numpy in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 10)) (1.25.0)
Requirement already satisfied: pandas in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 11)) (2.1.1)
Requirement already satisfied: pyvo in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 12)) (1.5.dev192+g75bcb73)
Requirement already satisfied: s3fs in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 13)) (2022.11.0)
Requirement already satisfied: tqdm in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 14)) (4.66.1)
Requirement already satisfied: alerce in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 15)) (1.2.0)
Requirement already satisfied: umap-learn[plot] in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from -r requirements.txt (line 16)) (0.5.5)
Requirement already satisfied: requests in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from acstools-&gt;-r requirements.txt (line 4)) (2.28.1)
Requirement already satisfied: PyYAML in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from acstools-&gt;-r requirements.txt (line 4)) (6.0)
Requirement already satisfied: pyerfa&gt;=2.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astropy-&gt;-r requirements.txt (line 5)) (2.0.0.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: astropy-iers-data&gt;=0.2023.7.31.0.32.45 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astropy-&gt;-r requirements.txt (line 5)) (0.2023.9.18.0.29.41)
Requirement already satisfied: packaging&gt;=19.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astropy-&gt;-r requirements.txt (line 5)) (23.1)
Requirement already satisfied: beautifulsoup4&gt;=4.8 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astroquery-&gt;-r requirements.txt (line 6)) (4.11.1)
Requirement already satisfied: html5lib&gt;=0.999 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astroquery-&gt;-r requirements.txt (line 6)) (1.1)
Requirement already satisfied: keyring&gt;=15.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from astroquery-&gt;-r requirements.txt (line 6)) (23.11.0)
Requirement already satisfied: bokeh&gt;=2.0.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (3.3.1)
Requirement already satisfied: fbpca&gt;=1.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (1.0)
Requirement already satisfied: memoization&gt;=0.3.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (0.4.0)
Requirement already satisfied: oktopus&gt;=0.1.2 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (0.1.2)
Requirement already satisfied: patsy&gt;=0.5.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (0.5.4)
Requirement already satisfied: scikit-learn&gt;=0.24.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (1.2.2)
Requirement already satisfied: uncertainties&gt;=3.1.4 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (3.1.7)
Requirement already satisfied: urllib3&gt;=1.23 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from lightkurve-&gt;-r requirements.txt (line 8)) (1.26.13)
Requirement already satisfied: contourpy&gt;=1.0.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (1.0.6)
Requirement already satisfied: cycler&gt;=0.10 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (4.38.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (1.4.4)
Requirement already satisfied: pillow&gt;=6.2.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (9.3.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from matplotlib-&gt;-r requirements.txt (line 9)) (2.8.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pytz&gt;=2020.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from pandas-&gt;-r requirements.txt (line 11)) (2022.6)
Requirement already satisfied: tzdata&gt;=2022.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from pandas-&gt;-r requirements.txt (line 11)) (2023.3)
Requirement already satisfied: aiobotocore~=2.4.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from s3fs-&gt;-r requirements.txt (line 13)) (2.4.1)
Requirement already satisfied: fsspec==2022.11.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from s3fs-&gt;-r requirements.txt (line 13)) (2022.11.0)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from s3fs-&gt;-r requirements.txt (line 13)) (3.8.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: scipy&gt;=1.3.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.12.0.dev0)
Requirement already satisfied: numba&gt;=0.51.2 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.58.1)
Requirement already satisfied: pynndescent&gt;=0.5 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.5.11)
Requirement already satisfied: datashader in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.16.0)
Requirement already satisfied: holoviews in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.18.1)
Requirement already satisfied: colorcet in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (3.0.1)
Requirement already satisfied: seaborn in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.13.0)
Requirement already satisfied: scikit-image in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.22.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numexpr&gt;=2.5 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from SOMPY==1.1.1-&gt;-r requirements.txt (line 17)) (2.8.7)
Requirement already satisfied: botocore&lt;1.27.60,&gt;=1.27.59 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiobotocore~=2.4.0-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.27.59)
Requirement already satisfied: wrapt&gt;=1.10.10 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiobotocore~=2.4.0-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.14.1)
Requirement already satisfied: aioitertools&gt;=0.5.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiobotocore~=2.4.0-&gt;s3fs-&gt;-r requirements.txt (line 13)) (0.11.0)
Requirement already satisfied: attrs&gt;=17.3.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (21.4.0)
Requirement already satisfied: charset-normalizer&lt;3.0,&gt;=2.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (2.1.1)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (6.0.3)
Requirement already satisfied: async-timeout&lt;5.0,&gt;=4.0.0a3 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (4.0.2)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.8.2)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.3.3)
Requirement already satisfied: aiosignal&gt;=1.1.2 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.3.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: soupsieve&gt;1.2 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from beautifulsoup4&gt;=4.8-&gt;astroquery-&gt;-r requirements.txt (line 6)) (2.3.2.post1)
Requirement already satisfied: Jinja2&gt;=2.9 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from bokeh&gt;=2.0.0-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (3.1.2)
Requirement already satisfied: tornado&gt;=5.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from bokeh&gt;=2.0.0-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (6.2)
Requirement already satisfied: xyzservices&gt;=2021.09.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from bokeh&gt;=2.0.0-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (2023.10.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six&gt;=1.9 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from html5lib&gt;=0.999-&gt;astroquery-&gt;-r requirements.txt (line 6)) (1.16.0)
Requirement already satisfied: webencodings in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from html5lib&gt;=0.999-&gt;astroquery-&gt;-r requirements.txt (line 6)) (0.5.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: jaraco.classes in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from keyring&gt;=15.0-&gt;astroquery-&gt;-r requirements.txt (line 6)) (3.2.3)
Requirement already satisfied: importlib-metadata&gt;=4.11.4 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from keyring&gt;=15.0-&gt;astroquery-&gt;-r requirements.txt (line 6)) (5.1.0)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from numba&gt;=0.51.2-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.41.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: autograd in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from oktopus&gt;=0.1.2-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (1.6.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: joblib&gt;=0.11 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from pynndescent&gt;=0.5-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.2.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from requests-&gt;acstools-&gt;-r requirements.txt (line 4)) (3.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from requests-&gt;acstools-&gt;-r requirements.txt (line 4)) (2022.9.24)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from scikit-learn&gt;=0.24.0-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (3.1.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: future in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from uncertainties&gt;=3.1.4-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (0.18.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyct&gt;=0.4.4 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from colorcet-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.5.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: dask in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2023.11.0)
Requirement already satisfied: multipledispatch in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.0.0)
Requirement already satisfied: param in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2.0.1)
Requirement already satisfied: toolz in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.12.0)
Requirement already satisfied: xarray in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2023.11.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyviz-comms&gt;=0.7.4 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (3.0.0)
Requirement already satisfied: panel&gt;=1.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.3.4)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: networkx&gt;=2.8 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from scikit-image-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2.8.8)
Requirement already satisfied: imageio&gt;=2.27 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from scikit-image-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2.33.0)
Requirement already satisfied: tifffile&gt;=2022.8.12 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from scikit-image-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2023.9.26)
Requirement already satisfied: lazy_loader&gt;=0.3 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from scikit-image-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from botocore&lt;1.27.60,&gt;=1.27.59-&gt;aiobotocore~=2.4.0-&gt;s3fs-&gt;-r requirements.txt (line 13)) (1.0.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: zipp&gt;=0.5 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from importlib-metadata&gt;=4.11.4-&gt;keyring&gt;=15.0-&gt;astroquery-&gt;-r requirements.txt (line 6)) (3.11.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: MarkupSafe&gt;=2.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from Jinja2&gt;=2.9-&gt;bokeh&gt;=2.0.0-&gt;lightkurve-&gt;-r requirements.txt (line 8)) (2.1.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: markdown in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (3.5.1)
Requirement already satisfied: markdown-it-py in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2.2.0)
Requirement already satisfied: linkify-it-py in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.0.3)
Requirement already satisfied: mdit-py-plugins in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.3.3)
Requirement already satisfied: bleach in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (5.0.1)
Requirement already satisfied: typing-extensions in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (4.4.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: click&gt;=8.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from dask-&gt;datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (8.1.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: cloudpickle&gt;=1.5.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from dask-&gt;datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (2.2.1)
Requirement already satisfied: partd&gt;=1.2.0 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from dask-&gt;datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.4.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: more-itertools in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from jaraco.classes-&gt;keyring&gt;=15.0-&gt;astroquery-&gt;-r requirements.txt (line 6)) (9.0.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: locket in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from partd&gt;=1.2.0-&gt;dask-&gt;datashader-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.0.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: uc-micro-py in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from linkify-it-py-&gt;panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (1.0.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: mdurl~=0.1 in /Users/bsipocz/.pyenv/versions/3.11.0/lib/python3.11/site-packages (from markdown-it-py-&gt;panel&gt;=1.0-&gt;holoviews-&gt;umap-learn[plot]-&gt;-r requirements.txt (line 16)) (0.1.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3</span> -&gt; <span class=" -Color -Color-Green">23.3.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># local code imports</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;code_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">data_structures</span> <span class="kn">import</span> <span class="n">MultiIndexDFObject</span>
<span class="kn">from</span> <span class="nn">gaia_functions</span> <span class="kn">import</span> <span class="n">Gaia_get_lightcurve</span>
<span class="kn">from</span> <span class="nn">HCV_functions</span> <span class="kn">import</span> <span class="n">HCV_get_lightcurves</span>
<span class="kn">from</span> <span class="nn">heasarc_functions</span> <span class="kn">import</span> <span class="n">HEASARC_get_lightcurves</span>
<span class="kn">from</span> <span class="nn">icecube_functions</span> <span class="kn">import</span> <span class="n">icecube_get_lightcurve</span>
<span class="kn">from</span> <span class="nn">panstarrs</span> <span class="kn">import</span> <span class="n">panstarrs_get_lightcurves</span>
<span class="kn">from</span> <span class="nn">plot_functions</span> <span class="kn">import</span> <span class="n">create_figures</span>
<span class="kn">from</span> <span class="nn">sample_selection</span> <span class="kn">import</span> <span class="p">(</span><span class="n">clean_sample</span><span class="p">,</span> <span class="n">get_green_sample</span><span class="p">,</span> <span class="n">get_hon_sample</span><span class="p">,</span> <span class="n">get_lamassa_sample</span><span class="p">,</span> <span class="n">get_lopeznavas_sample</span><span class="p">,</span>
    <span class="n">get_lyu_sample</span><span class="p">,</span> <span class="n">get_macleod16_sample</span><span class="p">,</span> <span class="n">get_macleod19_sample</span><span class="p">,</span> <span class="n">get_ruan_sample</span><span class="p">,</span> <span class="n">get_SDSS_sample</span><span class="p">,</span> <span class="n">get_sheng_sample</span><span class="p">,</span> <span class="n">get_yang_sample</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">TESS_Kepler_functions</span> <span class="kn">import</span> <span class="n">TESS_Kepler_get_lightcurves</span>
<span class="c1"># Note: WISE and ZTF data are temporarily located in a non-public AWS S3 bucket. It is automatically</span>
<span class="c1"># available from the Fornax SMCE, but will require user credentials for access outside the SMCE.</span>
<span class="kn">from</span> <span class="nn">WISE_functions</span> <span class="kn">import</span> <span class="n">WISE_get_lightcurves</span>
<span class="kn">from</span> <span class="nn">ztf_functions</span> <span class="kn">import</span> <span class="n">ZTF_get_lightcurve</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-sample">
<h2>1. Define the Sample<a class="headerlink" href="#define-the-sample" title="Permalink to this headline">#</a></h2>
<p>We define here a “gold” sample of spectroscopically confirmed changing look AGN and quasars. This sample includes both objects which change from type 1 to type 2 and also the opposite.  Future studies may want to treat these as seperate objects or seperate QSOs from AGN.</p>
<p>Bibcodes for the samples used are listed next to their functions for reference.</p>
<p>Functions used to grab the samples from the papers use Astroquery, NED, SIMBAD, Vizier, and in a few cases grab the tables from the html versions of the paper.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#build up the sample</span>
<span class="n">coords</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#choose your own adventure:</span>

<span class="c1">#get_lamassa_sample(coords, labels)  #2015ApJ...800..144L</span>
<span class="c1">#get_macleod16_sample(coords, labels) #2016MNRAS.457..389M</span>
<span class="c1">#get_ruan_sample(coords, labels) #2016ApJ...826..188R</span>
<span class="c1">#get_macleod19_sample(coords, labels)  #2019ApJ...874....8M</span>
<span class="c1">#get_sheng_sample(coords, labels)  #2020ApJ...889...46S</span>
<span class="c1">#get_green_sample(coords, labels)  #2022ApJ...933..180G</span>
<span class="c1">#get_lyu_sample(coords, labels)  #z32022ApJ...927..227L</span>
<span class="c1">#get_lopeznavas_sample(coords, labels)  #2022MNRAS.513L..57L</span>
<span class="c1">#get_hon_sample(coords, labels)  #2022MNRAS.511...54H</span>
<span class="n">get_yang_sample</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>   <span class="c1">#2018ApJ...862..109Y</span>

<span class="c1">#now get some &quot;normal&quot; QSOs for use in the classifier</span>
<span class="c1">#there are ~500K of these, so choose the number based on</span>
<span class="c1">#a balance between speed of running the light curves and whatever </span>
<span class="c1">#the ML algorithms would like to have</span>

<span class="c1">#num_normal_QSO = 50</span>
<span class="c1">#get_SDSS_sample(coords, labels, num_normal_QSO)</span>

<span class="c1"># remove duplicates and attach an objectid to the coords</span>
<span class="n">sample_table</span> <span class="o">=</span> <span class="n">clean_sample</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Changing Look AGN- Yang et al:  31
after duplicates removal, sample size: 30
</pre></div>
</div>
</div>
</div>
<section id="build-your-own-sample">
<h3>1.1 Build your own Sample<a class="headerlink" href="#build-your-own-sample" title="Permalink to this headline">#</a></h3>
<p>To build your own sample, you can follow the examples of functions above to grab coordinates from your favorite literature resource,</p>
<p>or</p>
<p>You can use <a class="reference external" href="https://docs.astropy.org/en/stable/io/ascii/read.html">astropy’s read</a> function to read in an input table
and then convert that table into a list of <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">skycoords</a></p>
</section>
<section id="write-out-your-sample-to-disk">
<h3>1.2 Write out your sample to disk<a class="headerlink" href="#write-out-your-sample-to-disk" title="Permalink to this headline">#</a></h3>
<p>At this point you may wish to write out your sample to disk and reuse that in future work sessions, instead of creating it from scratch again.</p>
<p>We would suggest to choose from various formats that fully supports the astropy objects, such as SkyCoord, in the so-called Mixin columns. E.g  Enhanced Character-Separated Values or ‘ecsv’ is one such format: https://docs.astropy.org/en/stable/io/ascii/ecsv.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;data/input_sample.ecsv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;data/input_sample.ecsv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.11.0/lib/python3.11/site-packages/astropy/table/connect.py:130,</span> in <span class="ni">TableWrite.__call__</span><span class="nt">(self, serialize_method, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="k">with</span> <span class="n">serialize_method_as</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">serialize_method</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">130</span>     <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.11.0/lib/python3.11/site-packages/astropy/io/registry/core.py:382,</span> in <span class="ni">UnifiedOutputRegistry.write</span><span class="nt">(self, data, format, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span>     <span class="nb">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_valid_format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>         <span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">fileobj</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span> <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_writer</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">382</span> <span class="k">return</span> <span class="n">writer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.11.0/lib/python3.11/site-packages/astropy/io/ascii/connect.py:28,</span> in <span class="ni">io_write</span><span class="nt">(format, table, filename, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="nb">format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^ascii\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">format</span>
<span class="ne">---&gt; </span><span class="mi">28</span> <span class="k">return</span> <span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.11.0/lib/python3.11/site-packages/astropy/io/ascii/ui.py:938,</span> in <span class="ni">write</span><span class="nt">(table, output, format, Writer, fast_writer, overwrite, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">lexists</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">938</span>         <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">NOT_OVERWRITING_MSG</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span> <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">941</span>     <span class="n">output</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

<span class="ne">OSError</span>: File data/input_sample.ecsv already exists. If you mean to replace it then use the argument &quot;overwrite=True&quot;.
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-sample-table-from-disk">
<h3>1.3 Load the sample table from disk<a class="headerlink" href="#load-the-sample-table-from-disk" title="Permalink to this headline">#</a></h3>
<p>Do only this step from this section when you have a previously generated sample table</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data/input_sample.ecsv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ecsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="temporary-cell-remove-when-all-functions-take-a-table-sample-table-rather-than-lists">
<h3>Temporary cell, remove when all functions take a Table sample_table rather than lists<a class="headerlink" href="#temporary-cell-remove-when-all-functions-take-a-table-sample-table-rather-than-lists" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coords_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;objectid&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;coord&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sample_table</span><span class="p">]</span>

<span class="n">labels_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sample_table</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="find-light-curves-for-these-targets-in-nasa-catalogs">
<h2>2. Find light curves for these targets in NASA catalogs<a class="headerlink" href="#find-light-curves-for-these-targets-in-nasa-catalogs" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>We search a curated list of time-domain catalogs from all NASA astrophysics archives</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Initialize Pandas MultiIndex data frame for storing the light curves</span>
<span class="n">df_lc</span> <span class="o">=</span> <span class="n">MultiIndexDFObject</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="heasarc-fermi-beppo-sax">
<h3>2.1 HEASARC: FERMI &amp; Beppo SAX<a class="headerlink" href="#heasarc-fermi-beppo-sax" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_serial</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1">#what is the size of error_radius for the fermi catalog that we will accept for our cross-matching?</span>
<span class="c1">#in degrees; chosen based on histogram of all values for these catalogs</span>
<span class="n">max_fermi_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  
<span class="n">max_sax_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c1">#list of missions to query and their corresponding error radii</span>
<span class="n">heasarc_cat</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;FERMIGTRIG&quot;</span><span class="p">,</span> <span class="s2">&quot;SAXGRBMGRB&quot;</span><span class="p">]</span>
<span class="n">error_radius</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_fermi_error_radius</span> <span class="p">,</span> <span class="n">max_sax_error_radius</span><span class="p">]</span>


<span class="c1">#go out and find all light curves in the above curated list which match our target positions</span>
<span class="n">df_lc_fermi</span> <span class="o">=</span> <span class="n">HEASARC_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">heasarc_cat</span><span class="p">,</span> <span class="n">error_radius</span><span class="p">)</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_fermi</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="irsa-ztf">
<h3>2.2 IRSA: ZTF<a class="headerlink" href="#irsa-ztf" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the nworkers arg to control the amount of parallelization in the data loading step</span>
<span class="n">df_lc_ZTF</span> <span class="o">=</span> <span class="n">ZTF_get_lightcurve</span><span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">nworkers</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_ZTF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="irsa-wise">
<h3>2.3 IRSA: WISE<a class="headerlink" href="#irsa-wise" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>use the unWISE light curves catalog which ties together all WISE &amp; NEOWISE 2010 - 2020 epochs.  Specifically it combined all observations at a single epoch to achieve deeper mag limits than individual observations alone.</p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2023AJ....165...36M/abstract">Meisner et al., 2023, 2023AJ….165…36M</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bandlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;W2&#39;</span><span class="p">]</span>
<span class="n">WISE_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>

<span class="n">df_lc_WISE</span> <span class="o">=</span> <span class="n">WISE_get_lightcurves</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="n">WISE_radius</span><span class="p">,</span> <span class="n">bandlist</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_WISE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-pan-starrs">
<h3>2.4 MAST: Pan-STARRS<a class="headerlink" href="#mast-pan-starrs" title="Permalink to this headline">#</a></h3>
<p>Query the Pan-STARRS API; based on this <a class="reference external" href="https://ps1images.stsci.edu/ps1_dr2_api.html">example</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Do a panstarrs search</span>
<span class="n">panstarrs_radius</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3600.0</span>    <span class="c1"># search radius = 1 arcsec</span>
<span class="n">df_lc_panstarrs</span> <span class="o">=</span> <span class="n">panstarrs_get_lightcurves</span><span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">panstarrs_radius</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_panstarrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-asteroid-terrestrial-impact-last-alert-system-atlas">
<h3>2.5 MAST: Asteroid Terrestrial-impact Last Alert System (ATLAS)<a class="headerlink" href="#mast-asteroid-terrestrial-impact-last-alert-system-atlas" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>All-sky stellar reference catalog</p></li>
<li><p>MAST hosts this catalog but there are three barriers to using it</p>
<ol class="arabic simple">
<li><p>it is unclear if the MAST <a class="reference external" href="https://archive.stsci.edu/hlsp/atlas-refcat2#section-a737bc3e-2d56-4827-9ab4-838fbf8d67c1">holdings</a> include the individual epoch photometry and</p></li>
<li><p>it is only accessible with casjobs, not through python notebooks.</p></li>
<li><p>magnitude range (g, r, i) &lt; 19mag makes it not relevant for this use case</p></li>
</ol>
</li>
</ul>
<p>One path forward if this catalog becomes scientifically interesting is to put in a MAST helpdesk ticket to see if 1) they do have the light curves, and 2) they could switch the catalog to a searchable with python version.  There are some ways of [accessing casjobs with python](&lt;https://github.com/spacetelescope/notebooks/blob/master/notebooks/MAST/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb), but not this particular catalog.</p>
</section>
<section id="mast-tess-kepler-and-k2">
<h3>2.6 MAST: TESS, Kepler and K2<a class="headerlink" href="#mast-tess-kepler-and-k2" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>use <a class="reference external" href="https://docs.lightkurve.org/index.html"><code class="docutils literal notranslate"><span class="pre">lightKurve</span></code></a> to search all 3 missions and download light curves</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#go get the lightcurves using lightkurve</span>
<span class="n">TESS_radius</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#arcseconds</span>
<span class="n">df_lc_TESS</span> <span class="o">=</span> <span class="n">TESS_Kepler_get_lightcurves</span><span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">TESS_radius</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_TESS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-hcv">
<h3>2.7 MAST: HCV<a class="headerlink" href="#mast-hcv" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://archive.stsci.edu/hlsp/hcv">hubble catalog of variables</a></p></li>
<li><p>using <a class="reference external" href="https://archive.stsci.edu/hst/hsc/help/HCV/HCV_API_demo.html">this notebook</a> as a reference to search and download light curves via API</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Do an HCV search</span>
<span class="n">HCV_radius</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3600.0</span> <span class="c1"># radius = 1 arcsec</span>
<span class="n">df_lc_HCV</span> <span class="o">=</span> <span class="n">HCV_get_lightcurves</span><span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">HCV_radius</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_HCV</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs">
<h2>3. Find light curves for these targets in relevant, non-NASA catalogs<a class="headerlink" href="#find-light-curves-for-these-targets-in-relevant-non-nasa-catalogs" title="Permalink to this headline">#</a></h2>
<section id="gaia">
<h3>3.1 Gaia<a class="headerlink" href="#gaia" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaiastarttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">df_lc_gaia</span> <span class="o">=</span> <span class="n">gaia_get_lightcurve</span><span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3600.</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_gaia</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gaia search took:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">gaiastarttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="asas-sn-all-sky-automated-survey-for-supernovae">
<h3>3.2 ASAS-SN (all sky automated survey for supernovae)<a class="headerlink" href="#asas-sn-all-sky-automated-survey-for-supernovae" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Has a <a class="reference external" href="https://asas-sn.osu.edu/photometry">website</a> that can be manually searched; but no API which would allow automatic searches from within this notebook</p></li>
<li><p>Magnitude range of this survey is not consistent with the magnitude range of our CLAGN.  If this catalog becomes scientifically interesting, one path forward would be to ask ASAS-SN team about implementing an API</p></li>
</ul>
</section>
<section id="icecube-neutrinos">
<h3>3.3 Icecube Neutrinos<a class="headerlink" href="#icecube-neutrinos" title="Permalink to this headline">#</a></h3>
<p>There are several <a class="reference external" href="https://icecube.wisc.edu/data-releases/2021/01/all-sky-point-source-icecube-data-years-2008-2018">catalogs</a> (basically one for each year of IceCube data from 2008 - 2018). The following code creates a large catalog by combining
all the yearly catalogs.
The IceCube catalog contains Neutrino detections with associated energy and time and approximate direction (which is uncertain by half-degree scales….). Usually, for active events only one or two Neutrinos are detected, which makes matching quite different compared to “photons”. For our purpose, we will list the top 3 events in energy that are within a given distance to the target.</p>
<p>This time series (time vs. neutrino energy) information is similar to photometry. We choose to storing time and energy in our data structure, leaving error = 0. What is <strong>not</strong> stored in this format is the distance or angular uncertainty of the event direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_lc_icecube</span> <span class="o">=</span> <span class="n">icecube_get_lightcurve</span><span class="p">(</span><span class="n">coords_list</span> <span class="p">,</span> <span class="n">labels_list</span> <span class="p">,</span>
                                   <span class="n">icecube_select_topN</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                                   <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#add the resulting dataframe to all other archives</span>
<span class="n">df_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_lc_icecube</span><span class="p">)</span>
<span class="n">end_serial</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#benchmarking</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total time for serial archive calls is &#39;</span><span class="p">,</span> <span class="n">end_serial</span> <span class="o">-</span> <span class="n">start_serial</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="parallel-processing-the-archive-calls">
<h2>4. Parallel Processing the archive calls<a class="headerlink" href="#parallel-processing-the-archive-calls" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define some variables in case the above serial cells are not run</span>
<span class="n">max_fermi_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  
<span class="n">max_sax_error_radius</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">heasarc_cat</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;FERMIGTRIG&quot;</span><span class="p">,</span> <span class="s2">&quot;SAXGRBMGRB&quot;</span><span class="p">]</span>
<span class="n">error_radius</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_fermi_error_radius</span> <span class="p">,</span> <span class="n">max_sax_error_radius</span><span class="p">]</span>
<span class="n">bandlist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;W1&quot;</span><span class="p">,</span> <span class="s2">&quot;W2&quot;</span><span class="p">]</span>
<span class="n">wise_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="n">panstarrs_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3600.0</span>  <span class="c1"># search radius = 1 arcsec</span>
<span class="n">lk_radius</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># arcseconds</span>
<span class="n">hcv_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3600.0</span>  <span class="c1"># radius = 1 arcsec</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of workers to use in the parallel processing pool</span>
<span class="c1"># this should equal the total number of archives called</span>
<span class="n">n_workers</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># &quot;spawn&quot; new processes because it uses less memory and is thread safe</span>
<span class="c1"># in particular, this is required for pd.read_parquet (used by ZTF_get_lightcurve)</span>
<span class="c1"># https://stackoverflow.com/questions/64095876/multiprocessing-fork-vs-spawn</span>
<span class="n">mp</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;spawn&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the ZTF call can be parallelized internally, separate from the pool launched below.</span>
<span class="c1"># these parallelizations are mutually exclusive, so we must turn off the internal parallelization.</span>
<span class="n">ztf_nworkers</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># note that the ZTF call is relatively slow compared to other archives.</span>
<span class="c1"># if you want to query for a large number of objects, it will be faster to call ZTF individually</span>
<span class="c1"># (code above) and use the internal parallelization. try 8-12 workers.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parallel_starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># start a multiprocessing pool and run all the archive queries</span>
<span class="n">parallel_df_lc</span> <span class="o">=</span> <span class="n">MultiIndexDFObject</span><span class="p">()</span>  <span class="c1"># to collect the results</span>
<span class="n">callback</span> <span class="o">=</span> <span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">append</span>  <span class="c1"># will be called once on the result returned by each archive</span>
<span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>

    <span class="c1"># start the processes that call the archives</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">Gaia_get_lightcurve</span><span class="p">,</span> <span class="p">(</span><span class="n">sample_table</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3600.</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">HEASARC_get_lightcurves</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">heasarc_cat</span><span class="p">,</span> <span class="n">error_radius</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">HCV_get_lightcurves</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">hcv_radius</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">icecube_get_lightcurve</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">panstarrs_get_lightcurves</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">panstarrs_radius</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">TESS_Kepler_get_lightcurves</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">lk_radius</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">WISE_get_lightcurves</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">wise_radius</span><span class="p">,</span> <span class="n">bandlist</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
        <span class="n">ZTF_get_lightcurve</span><span class="p">,</span> <span class="p">(</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">labels_list</span><span class="p">,</span> <span class="n">ztf_nworkers</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span>
    <span class="p">)</span>

    <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># signal that no more jobs will be submitted to the pool</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># wait for all jobs to complete, including the callback</span>

<span class="n">parallel_endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How long did parallel processing take?</span>
<span class="c1"># and look at the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel processing took&#39;</span><span class="p">,</span> <span class="n">parallel_endtime</span> <span class="o">-</span> <span class="n">parallel_starttime</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">parallel_df_lc</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the data for future use with ML notebook</span>
<span class="c1">#parquet_savename = &#39;output/df_lc_090723_yang.parquet&#39;</span>
<span class="c1">#parallel_df_lc.data.to_parquet(parquet_savename)</span>
<span class="c1">#print(&quot;file saved!&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># could load a previously saved file in order to plot</span>
<span class="c1">#parquet_loadname = &#39;output/df_lc_090723_yang.parquet&#39;</span>
<span class="c1">#parallel_df_lc = MultiIndexDFObject()</span>
<span class="c1">#parallel_df_lc.data = pd.read_parquet(parquet_loadname)</span>
<span class="c1">#print(&quot;file loaded!&quot;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-plots-of-luminosity-as-a-function-of-time">
<h2>5. Make plots of luminosity as a function of time<a class="headerlink" href="#make-plots-of-luminosity-as-a-function-of-time" title="Permalink to this headline">#</a></h2>
<p>Model plots after <a class="reference external" href="https://arxiv.org/pdf/2111.09391.pdf">van Velzen et al., 2021</a>.</p>
<p><strong>Note</strong> that in the following, we can either plot the results from <code class="docutils literal notranslate"><span class="pre">df_lc</span></code> (from the serial call) or <code class="docutils literal notranslate"><span class="pre">parallel_df_lc</span></code> (from the parallel call). By default (see next cell) the output of the parallel call is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">create_figures</span><span class="p">(</span><span class="n">coords_list</span> <span class="o">=</span> <span class="n">coords_list</span> <span class="p">,</span>
                   <span class="n">df_lc</span> <span class="o">=</span> <span class="n">parallel_df_lc</span><span class="p">,</span> <span class="c1"># either df_lc (serial call) or parallel_df_lc (parallel call)</span>
                   <span class="n">show_nbr_figures</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                   <span class="n">save_output</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">,</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>This work made use of:</p>
<ul class="simple">
<li><p>Astroquery; Ginsburg et al., 2019, 2019AJ….157…98G</p></li>
<li><p>Astropy; Astropy Collaboration 2022, Astropy Collaboration 2018, Astropy Collaboration 2013, 2022ApJ…935..167A, 2018AJ….156..123A, 2013A&amp;A…558A..33A</p></li>
<li><p>Lightkurve; Lightkurve Collaboration 2018, 2018ascl.soft12013L</p></li>
<li><p>acstools; https://zenodo.org/record/7406933#.ZBH1HS-B0eY</p></li>
<li><p>unWISE light curves; Meisner et al., 2023, 2023AJ….165…36M</p></li>
<li><p>Alerce; Forster et al., 2021, 2021AJ….161..242F</p></li>
</ul>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Time Domain</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="lc_classifier.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Light Curve Classifier</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Fornax developers<br/>
  
      &copy; Copyright 2021-2023, Fornax developers.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>